<!DOCTYPE html>
<html>
<body>
<font size ="+2">
<a href="https://github.com/sirstanel/sirstanel.github.io">Github link</a><br>
</font>

<textarea class="textarea" rows=50 cols=90 id="input" value="input">
{
  "Sample build order",
  "secondsDelayed": -3,
  "buildSteps":[
    {"textDisplay":"4 probe (5)",                                                                                                        "time":"0:01"},
    {"textDisplay":"5 probe (6)",                                                                                                        "time":"0:16"},
    {"textDisplay":"6 probe (7)",                                                                                                        "time":"0:29"},
    {"textDisplay":"7 75% send a probe to natural",                                                                                      "time":"0:38"},
    {"textDisplay":"7 probe (8)",                                                                                                        "time":"0:42"},
    {"textDisplay":"8 pylon and send it to mine natural and after it returns to main send it to mine main",                              "time":"0:50"},
    {"textDisplay":"8 probe (9)",                                                                                                        "time":"0:57"},
    {"textDisplay":"9 probe (10)",                                                                                                       "time":"1:12"},
    {"textDisplay":"10 probe (11)",                                                                                                      "time":"1:25"},
    {"textDisplay":"11 probe (12) and send the 11th probe to natural",                                                                   "time":"1:40"},
    {"textDisplay":"12 forge and send it to scout horizontically on circuit breakers",                                                   "time":"1:48"},
    {"textDisplay":"12 probe (13) and send the 13th probe to natural",                                                                   "time":"1:51"},
    {"textDisplay":"13 nexus",                                                                                                          "time":"2:14"},
    {"textDisplay":"13 1st cannon at natural",                                                                                           "time":"2:25"},
    {"textDisplay":"13 probe (14)",                                                                                                      "time":"2:28"},
    {"textDisplay":"14 probe (15)",                                                                                                      "time":"2:41"}
  ]
}
</textarea>
<button onclick="GenerateTriggers()">Generate triggers</button>
<textarea class="textarea" rows=50 cols=90 id="output" placeholder="output"></textarea>

<script>
function GenerateTrigger(buildStep, secondsDelayed) {
  var time = buildStep.time.split(":");
  var igtSecondsDelayed = Math.floor((parseInt(time[0]*60) + parseInt(time[1]) + parseInt(secondsDelayed)) * 1.5);
  var textDisplayShortName = buildStep.textDisplay.substr(buildStep.textDisplay);
  return `Trigger("Force 1"){
  Conditions:
    Elapsed Time(At least, ${igtSecondsDelayed});
  Actions:
    Display Text Message(Always Display, "${textDisplayShortName}");
  }
  `
}

function GenerateTriggers() {
  var inputVal = document.getElementById("input").value;
  var obj = JSON.parse(inputVal)
  var i;
  var outputStr = "";
  for (i = 0; i < obj.buildSteps.length; i++) {
    outputStr += GenerateTrigger(obj.buildSteps[i], obj.secondsDelayed);

  }
  document.getElementById("output").innerHTML = outputStr;
  return inputVal
}

window.addEventListener("error", handleError, true);

function handleError(evt) {
  alert("Generate triggers error, please check your input text again");
}
</script>

</body>
</html>
